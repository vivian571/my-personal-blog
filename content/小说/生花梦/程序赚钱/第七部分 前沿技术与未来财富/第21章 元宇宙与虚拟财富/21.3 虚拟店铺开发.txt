21.3 装修费0元: 手把手教你用Unity搭建一家"日不落"虚拟旗舰店

想象一下：
你在黄金地段开了一家潮牌店。
- 不需要付几十万的房租。
- 不需要雇店员看店。
- 不需要交水电费。
- 客户来自全世界，24小时不打烊。

这就是虚拟店铺的魅力。
在这一节，我将带你从零开始，用程序员最熟悉的工具——**Unity**，搭建一个功能完整的元宇宙虚拟店铺。
不仅要好看，还要能"收钱"。


一、为什么选择Unity?

虽然Decentraland有自己的SDK，但如果我们想做独立站，或者通过 Spatial、VRChat 这样的平台发布，**Unity 是绝对的王者**。
- **跨平台**: 写一次，发布到 WebGL(网页)、Android、iOS、甚至VR眼镜。
- **资产丰富**: Asset Store 里有成千上万得现成模型，"装修"就像搭乐高。
- **C#**: 面向对象编程，对程序员极度友好。


二、实战: 搭建店铺的三个核心步骤

假设我们要开一家"赛博朋克风格的NFT画廊"。

**步骤1: 场景搭建 (装修)**

打开 Unity，新建 3D URP 项目(画质更好)。

1. **导入资产**: 去Asset Store下载一个免费的 "Sci-Fi Showroom" 场景包。
2. **摆放商品**: 在墙上挂几个 Quad (平面)，贴上你的 NFT 图片材质。
3. **灯光渲染**: 打几个紫色的聚光灯(Spot Light)，烘焙光照贴图(Bakery)。
   瞬间，那个"赛博味"就出来了。

**步骤2: 编写交互逻辑 (C#)**

店铺不能光能看，还要能交互。
我们要实现：**当玩家走到画作前，按E键，弹出购买窗口。**

创建一个脚本 `InteractableItem.cs`，挂载在画作上。

```csharp
using UnityEngine;
using UnityEngine.UI;

public class InteractableItem : MonoBehaviour
{
    public string nftUrl = "https://opensea.io/assets/xxx"; // 购买链接
    public float interactDistance = 3.0f; // 交互距离
    public GameObject tipsUI; // 提示UI "按E购买"

    private Transform player;

    void Start()
    {
        player = GameObject.FindGameObjectWithTag("Player").transform;
        tipsUI.SetActive(false);
    }

    void Update()
    {
        // 计算玩家与物品的距离
        float dist = Vector3.Distance(transform.position, player.position);

        if (dist <= interactDistance)
        {
            tipsUI.SetActive(true);
            
            // 监听键盘输入
            if (Input.GetKeyDown(KeyCode.E))
            {
                OpenShop();
            }
        }
        else
        {
            tipsUI.SetActive(false);
        }
    }

    void OpenShop()
    {
        Debug.Log("正在前往购买页面...");
        // 调用浏览器打开链接
        Application.OpenURL(nftUrl);
    }
}
```

就这么简单。
现在，玩家走近画作，屏幕会出现提示，按下E，直接跳转OpenSea付款。

**步骤3: 对接区块链钱包 (Web3 登录)**

如果想在游戏里直接付款，而不是跳转外链，怎么办？
我们需要集成 **Web3 Unity SDK** (比如 ChainSafe 或 Moralis)。

1. 导入 ChainSafe SDK。
2. 在 Start 场景做一个 "Connect Wallet" 按钮。
3. 编写支付逻辑：

```csharp
async public void BuyNFT()
{
    string contractAddress = "0x123...";
    string abi = "[...]"; // 智能合约ABI
    
    // 调用智能合约的 Mint 函数
    try {
        string response = await Web3.Contract.Send(
            contractAddress, 
            abi, 
            "mint", 
            new object[]{ }
        );
        print("购买成功! 交易哈希: " + response);
    } catch (System.Exception e) {
        print("购买失败: " + e.Message);
    }
}
```

这样，你的店铺就成了一个**DApp (去中心化应用)**。
用户链接小狐狸钱包(MetaMask)，点一下按钮，签名，扣款，NFT直接发到他钱包里。
整个过程没有任何中间商。


三、如何把店铺发布出去?

做好了，怎么让别人来逛？

**方案A: 发布到 Spatial (最简单)**
Spatial 是目前最火的Web3空间平台，支持Unity上传。
1. 下载 Spatial SDK。
2. 在Unity里把你的场景打包成 `.unitypackage`。
3. 把文件拖进 Spatial 官网。
**优点**: 自带流量，手机网页VR都能看，支持多人在线语音。
**缺点**: 功能受限，不能写太复杂的自定义C#代码。

**方案B: 导出 WebGL (最独立)**
1. Unity -> Build Settings -> WebGL。
2. 生成一个 `index.html` 和一堆数据文件。
3. 把这些文件上传到你的服务器(或 GitHub Pages)。
**优点**: 完全可控，你拥有所有数据。
**缺点**: 前期没流量，需要自己推广。


四、运营与变现: 虚拟店铺怎么赚钱?

店开了，怎么搞钱？

**模式1: 卖NFT**
这是最直接的。画廊卖画，鞋店卖鞋。
通过极具沉浸感的3D展示，转化率远高于平面的网页图片。
让用户可以360度旋转检视商品，甚至试穿。

**模式2: 广告位出租**
如果你的店铺装修得特别酷，每天有几千人来逛。
你墙上的"海报位"就是钱。
你可以把墙面租给其他项目方，挂他们的海报。
**按月收租，躺着赚钱。**

**模式3: 门票收入**
搞活动。
比如"周五晚上虚拟电音节"，或者"大佬技术分享会"。
设置个门槛：只有持有特定NFT门票的人才能进入你的房间。
Unity里写个逻辑判断一下钱包资产就行。


五、避坑指南: 别做"空荡荡"的店铺

**坑一: 忽视性能优化**
很多开发者在PC上开发，用几千万面的模型，打几十个实时光。
结果发布到网页上，用户打开要加载5分钟，进去只有1帧。
**记住：Web端的性能很弱。**
- 图片要压缩。
- 模型要减面。
- 灯光要烘焙(Bake)。
**让用户进得来，比什么都重要。**

**坑二: 缺乏社交互动**
如果店里只有用户一个人，他逛一圈就会觉得无聊走了。
**元宇宙的核心是"人"**。
一定要加多人同步功能(Multiplayer)。
让用户能看到别人的替身(Avatar)，能打字聊天，能开语音。
大家能聚在一起吹牛，你的店才有烟火气。

**坑三: 操作反人类**
别搞那些复杂的WASD+鼠标组合键。
很多手机用户根本操作不过来。
**尽量做点击式移动(Teleport)**，点哪走哪，简单直接。


六、总结: 下一代电商的雏形

你现在看到的"虚拟店铺"，虽然还很粗糙，像90年代的网页。
但这在酝酿一场革命。

从"淘宝的图文详情页"，到"抖音的直播带货"，再到"元宇宙的3D体验"。
**购物体验永远在向"更真实、更沉浸"的方向进化。**

那个在Unity里敲代码搭积木的你，正在构建的不仅仅是一个3D场景。
而是**下个十年的亚马逊**。

拿起你的键盘，去建造属于你的那座数字大厦吧。
在这里，物理引力束缚不了你，贫穷限制不了想象力。
唯一的限制，只有你的代码。

---
第21章完结。
本章我们也完成了"第七部分：前沿技术与未来财富"的全部内容。

从AI预测市场，到DeFi被动收入，再到元宇宙虚拟地产。
我们看到了技术如何重构财富的定义。

但是，技术是把双刃剑。
可以用来造福，也可以用来作恶。
在追求财富的路上，我们还需要最后一道防线：**安全与备份**。
如果你的私钥丢了怎么办？如果交易所跑路了怎么办？

在下一部分，我们或许该谈谈如何守住你的财富。
(虽然大纲里这部分已经讲完了，但作为全书结尾，我们是不是该有一个宏大的总结？)

**全书大纲规划的章节已更新完毕。**
请指示是否需要进行全书总结或补充其他章节。
